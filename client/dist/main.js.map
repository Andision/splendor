{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.tsx","webpack:///external \"React\"","webpack:///external \"ReactDOM\"","webpack:///./node_modules/favico.js/favico.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","globalShowError","resp","errorTimeout","colors","gemColors","concat","levelNames","mapColors","gems","game","callback","symbol","uuid","map","color","cName","clickable","className","onClick","undefined","mapNobles","nobles","noble","Noble","Card","React","PureComponent","card","this","props","buyer","buy","reserver","e","preventDefault","reserve","level","id","src","points","cost","visit","requirement","Player","state","editingName","editName","setState","target","focusName","select","submitName","rename","keypress","pid","playerSelector","selectPlayer","collection","set","cards","length","stats","Fragment","you","youName","discard","reserved","reservedCount","nreserved","type","autoFocus","onKeyPress","onFocus","onBlur","onChange","turn","selectedPlayer","Level","remaining","Game","ticker","timeoutAudio","players","chat","decks","log","winner","error","phase","showChat","showLog","chatNotify","turn_seconds","turn_deadline","nowMs","Date","now","isMyTurn","updateState","favicon","badge","document","getElementById","play","alert","lastLocalChat","lastRemoteChat","msg","scroller","getElementsByClassName","scrollTop","scrollHeight","loginArgs","take","act","confirm","player","fetch","gid","method","json","action","nextTurn","poll","stat","turnRemaining","Math","ceil","max","stopTimeoutAudio","pause","currentTime","syncTimeoutAudio","paused","catch","chatBox","which","body","JSON","stringify","window","setInterval","loop","clearInterval","score","logLine","chatLine","levels","style","bottom","opacity","ErrorMsg","GameCreator","startKey","loading","lobby","joined","gameName","turnSecondsInput","errorOpacity","creating","join","session","readSession","save","status","showError","createGame","result","clear","clearTimeout","setTimeout","parsedTurnSeconds","parseInt","trim","turnSeconds","Number","isFinite","headers","history","replaceState","start","localStorage","getItem","parse","saveRaw","startGame","nameChange","turnSecondsChange","keyPress","location","pathname","then","substring","min","href","Favico","position","onclick","ReactDOM","render","opt","_opt","_orig","_h","_w","_canvas","_context","_img","_ready","_lastBadge","_running","_readyCb","_stop","_browser","_animTimeout","_drawTimeout","_doc","_def","bgColor","textColor","fontFamily","fontStyle","animation","elementId","dataUrl","win","ff","InstallTrigger","chrome","opera","navigator","userAgent","indexOf","ie","safari","toString","HTMLElement","supported","_queue","icon","reset","clearRect","drawImage","link","setIcon","run","forEach","a","options","shift","abs","x","y","w","h","len","circle","more","beginPath","font","floor","textAlign","moveTo","lineTo","quadraticCurveTo","arc","PI","fillStyle","g","b","fill","closePath","stroke","fillText","rectangle","fillRect","drawVideo","video","ended","duration","hexToRgb","hex","replace","exec","merge","def","attrname","mergedOpt","getIcon","elm","element","setAttribute","getAttribute","getElementsByTagName","test","getLink","createElement","appendChild","canvas","url","toDataURL","old","parentNode","removeChild","types","fade","none","pop","popFade","slide","cb","revert","step","animationType","hidden","msHidden","webkitHidden","mozHidden","toLowerCase","isUp","isLeft","hasAttribute","onload","height","width","getContext","ready","init","number","opts","q","push","Error","message","videoElement","addEventListener","image","imageElement","newImg","ratio","webcam","URL","createObjectURL","obj","newVideo","getUserMedia","oGetUserMedia","msGetUserMedia","mozGetUserMedia","webkitGetUserMedia","audio","stream","browser"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import * as React from \"react\"\nimport * as ReactDOM from \"react-dom\"\nimport \"favico.js\"\n\ntype ColorT = 'w' | 'u' | 'g' | 'b' | 'r'\ntype GemT = ColorT | '*'\n\ninterface CostT {\n  w?: number\n  u?: number\n  g?: number\n  b?: number\n  r?: number\n}\n\ninterface GemsT extends CostT {\n  '*'?: number\n}\n\ninterface CardT {\n  color: string\n  points: number\n  uuid: string\n  cost: CostT\n  level: string\n}\n\ninterface CardsT {\n  w?: CardT[]\n  u?: CardT[]\n  g?: CardT[]\n  b?: CardT[]\n  r?: CardT[]\n}\n\ninterface NobleT {\n  id: number\n  points: number\n  uuid: string\n  requirement: CostT\n}\n\ninterface PlayerT {\n  id: number\n  name: string\n  uuid: string\n  reserved: CardT[]\n  nobles: NobleT[]\n  cards: CardsT\n  gems: GemsT\n  score: number\n}\n\ninterface LogT {\n  pid: number\n  time: number\n  msg: string\n}\n\ninterface GameT {\n  players: PlayerT[]\n  cards: { [level: string]: CardT[] }\n  decks: { [level: string]: number }\n  log: LogT[]\n  gems: GemsT\n  nobles: NobleT[]\n  winner: number | null\n  turn: number\n  turn_seconds?: number\n  turn_deadline?: number | null\n}\n\ninterface ChatT {\n  time: number\n  pid: number\n  name: string\n  msg: string\n}\n\ninterface GameState extends GameT {\n  mode: string\n  selectedPlayer: number\n  phase: string\n  showChat: boolean\n  showLog: boolean\n  chat: ChatT[]\n  chatNotify: boolean\n  nowMs: number\n}\n\ninterface ServerResponse {\n  error?: string\n  state: GameT\n  chat: ChatT[]\n  status?: number\n  result: {\n    error?: string\n  }\n}\n\nlet globalShowError = (resp: ServerResponse) => { return false }\n\n(function () {\n  let errorTimeout = 0\n  const colors = ['b', 'u', 'w', 'g', 'r']\n  const gemColors = colors.concat(['*'])\n  const levelNames = ['level1', 'level2', 'level3']\n\n  function mapColors(gems: GemsT, game: Game, callback: (color: GemT) => void, symbol: string, uuid: string | number) {\n    return gemColors.map((color: GemT) => {\n      var cName = color + \"chip\"\n      if (color === '*') cName = \"schip\"\n      const clickable = color !== '*'\n      return (\n        <div\n          className={\"gem \" + cName + (clickable ? \" gem-clickable\" : \" gem-disabled\")}\n          key={color + \"_colors_\" + uuid}\n          onClick={clickable ? callback.bind(game, color) : undefined}\n        >\n          <div className=\"bubble\">{gems[color]}</div>\n          <div className=\"underlay\">{clickable ? symbol : ''}</div>\n        </div>\n      );\n    });\n  }\n\n  function mapNobles(nobles: NobleT[], game: Game) {\n    return nobles.map((noble) => {\n      return (\n        <Noble key={noble.uuid} noble={noble} game={game}/>\n      );\n    });\n  }\n\n  class Card extends React.PureComponent<{ card: CardT, game: Game }, {}> {\n    render() {\n      const card = this.props.card\n      const game = this.props.game\n      var buyer = game.buy.bind(game, card.uuid)\n      const reserver = (e: React.MouseEvent<HTMLDivElement>) => {\n        e.preventDefault();\n        game.reserve.bind(game)(card.uuid)\n      }\n\n      if (card.color) {\n        return (\n          <div\n            className={\"card card-\" + card.color + \" card-\" + card.level}\n            id={card.uuid}\n          >\n            <div className=\"reserve\" onClick={reserver}>\n              <img className=\"floppy\" src=\"client/img/floppy.png\" />\n            </div>\n            <div className=\"overlay\" onClick={buyer}></div>\n            <div className=\"underlay\">\n              <div className=\"header\">\n                <div className={\"color \" + card.color + \"gem\"}>\n                </div>\n                <div className=\"points\">\n                  {card.points > 0 && card.points}\n                </div>\n              </div>\n              <div className=\"costs\">\n                {colors.map((color: ColorT) => {\n                  if(card.cost[color] > 0) {\n                    return (\n                      <div\n                        key={card.uuid + \"_cost_\" + color}\n                        className={\"cost \" + color}\n                      >\n                        {card.cost[color]}\n                      </div>\n                    )\n                  }\n                })}\n              </div>\n            </div>\n          </div>\n        );\n      } else {\n        return (\n          <div className = {\"deck \" + card.level}></div>\n        )\n      }\n    }\n  }\n\n  class Noble extends React.PureComponent<{ noble: NobleT, game: Game }, {}> {\n    render() {\n      const noble = this.props.noble\n      const game = this.props.game\n      const visit = game.noble.bind(game, noble.uuid)\n\n      return (\n        <div className=\"noble\" onClick={visit} id={\"noble\" + noble.id}>\n          <div className=\"side-bar\">\n            <div className=\"points\">\n              {noble.points > 0 && noble.points}\n            </div>\n            <div className=\"requirement\">\n              {colors.map((color: ColorT) => {\n                if(noble.requirement[color] > 0) {\n                  return (\n                    <div\n                      key={noble.uuid + \"_req_\" + color}\n                      className={\"requires \" + color}\n                    >\n                      {noble.requirement[color]}\n                    </div>\n                  )\n                }\n              })}\n            </div>\n          </div>\n        </div>\n      );\n    }\n  }\n\n  interface PlayerProps {\n    game: Game\n    pid: number\n    cards: CardsT\n    gems: GemsT\n    name: string\n    points: number\n    nobles: NobleT[]\n    reserved: CardT[]\n    nreserved: number\n    selectedPlayer: number\n  }\n\n  class Player extends React.PureComponent<PlayerProps, { editingName: string | null }> {\n    state = { editingName: null as string | null }\n\n    editName = (e: React.ChangeEvent<HTMLInputElement>) => {\n      this.setState({ editingName: e.target.value })\n    }\n\n    focusName = (e: React.FocusEvent<HTMLInputElement>) => {\n      e.target.select()\n    }\n\n    submitName = () => {\n      this.props.game.rename(this.state.editingName);\n      this.setState({ editingName: null })\n    }\n\n    keypress = (e: React.KeyboardEvent<HTMLInputElement>) => {\n      if (e.key === \"Enter\") {\n        this.submitName()\n      }\n    }\n\n    render() {\n      const game = this.props.game\n      const pid = this.props.pid\n      const playerSelector = game.selectPlayer.bind(game, pid)\n      const collection: { [color: string]: { cards: number, gems: number } } = {}\n\n      gemColors.map((color: ColorT) => {\n        collection[color] = {'cards': 0, 'gems': this.props.gems[color]};\n      })\n\n      const set = colors.map((color: ColorT) => {\n        var cards = this.props.cards[color].map((card: CardT) => {\n          collection[color]['cards'] += 1;\n          return (\n            <div\n              key={pid + \"_card_\" + card.uuid}\n              className=\"colorSetInner\"\n            >\n              <Card key={card.uuid} card={card} game={game}/>\n            </div>\n          );\n        })\n        return (\n          <div key={pid + \"_set_\" + color} className=\"colorSet\">\n            {cards}\n            <div className={cards.length > 0 ? \"endcap\" : \"spacer\"}></div>\n          </div>\n        )\n      })\n\n      const stats = gemColors.map((color) => {\n        return (\n          <div className=\"statSet\" key={\"stat\" + color}>\n            <div className={`stat stat${color === '*' ? 'y' : color}`}>{collection[color]['gems'] + (color == '*' ? '' : ' / ' + collection[color]['cards'])}</div>\n            {color === '*' ? <React.Fragment /> : <div><img className=\"labelImg\" src=\"client/img/labels.png\" /></div>}\n          </div>\n        )\n      })\n\n      const you = (game.props.pid === pid ? \" you selected\" : \"\")\n      const youName = (game.props.pid === pid ? \" (you)\" : \"\")\n      const gems = mapColors(this.props.gems, game, game.discard, 'X', pid)\n      const reserved = this.props.reserved ? this.props.reserved.map((card) => {\n        return (\n          <Card key={card.uuid + \"_inner\"} card={card} game={game}/>\n        );\n      }) : []\n      const reservedCount = this.props.reserved ? reserved.length : this.props.nreserved\n      const nobles = mapNobles(this.props.nobles, game)\n\n      return (\n        <div className={\"player\" + you}>\n          <div className=\"playerHeader\">\n            <div className=\"playerPoints\">{this.props.points}</div>\n            {this.state.editingName == null ?\n              <>\n                <div className=\"playerName\" onClick={playerSelector}>{this.props.name}</div>\n                {game.props.pid === pid && this.state.editingName == null ?\n                  <div className=\"pencil\" onClick={() => this.setState({ editingName: this.props.name })}>✏️</div> : <React.Fragment />\n                }\n              </> :\n              <div className=\"playerName\">\n                <input className=\"nameInput\" type=\"text\" value={this.state.editingName} autoFocus={true} onKeyPress={this.keypress} onFocus={this.focusName} onBlur={this.submitName} onChange={this.editName} />\n              </div>\n            }\n            <div className=\"playerName2\">{youName}</div>\n            {game.state.turn === pid &&\n              <div className=\"turnIndicator\">&#8592;</div>\n            }\n          </div>\n          {game.state.selectedPlayer === pid ?\n            <div className=\"floater\">\n              <div className=\"cards\">\n                {set}\n              </div>\n              <div className=\"nobles\">\n                {nobles}\n              </div>\n              <div className=\"gems\">\n                {gems}\n              </div>\n              <div className=\"reserveArea\">\n                { reservedCount > 0 &&\n                  <div>\n                    <div className=\"reserveText\">\n                      reserved\n                    </div>\n                    <div className=\"reserveCards\">\n                      {reserved}\n                    </div>\n                  </div>\n                }\n              </div>\n            </div> :\n            <div className=\"stats\">\n              <div className=\"gem-stats\">{stats}</div>\n              <div className=\"reservedStat\">\n                {reserved}\n              </div>\n            </div>\n          }\n        </div>\n      );\n    }\n  }\n\n  class Level extends React.PureComponent<{ name: string, remaining: number, game: Game, cards: CardT[] }, {}> {\n    render() {\n      return (\n        <div>\n          <div className={\"deck \" + this.props.name}>\n            <div className=\"remaining\">\n              {this.props.remaining}\n            </div>\n            <div className=\"overlay\"></div>\n            <div className=\"reserve\" onClick={this.props.game.reserve.bind(this.props.game, this.props.name)}>\n              <img className=\"floppy\" src=\"client/img/floppy.png\" />\n            </div>\n          </div>\n          <div className={\"c_\" + this.props.name + \" face-up-cards\"}>\n            <div className=\"cards-inner\">\n              {this.props.cards && this.props.cards.map((card) =>\n                <Card key={card.uuid} card={card} game={this.props.game}/>\n              )}\n            </div>\n          </div>\n        </div>\n      );\n    }\n  }\n\nclass Game extends React.PureComponent<{ gid: string, pid: number, uuid: string }, GameState> {\n    ticker: number | null = null\n    timeoutAudio: HTMLAudioElement | null = null\n\n    state = {\n      players: [],\n      gems: {},\n      cards: {},\n      chat: [],\n      decks: {},\n      nobles: [],\n      log: [],\n      turn: -1,\n      winner: null,\n      mode: \"normal\",\n      error: null,\n      selectedPlayer: -1,\n      phase: \"pregame\",\n      showChat: false,\n      showLog: false,\n      chatNotify: false,\n      turn_seconds: 30,\n      turn_deadline: null,\n      nowMs: Date.now(),\n    } as GameState\n\n    isMyTurn = (turn: number) => {\n      return (turn == this.props.pid);\n    }\n\n    updateState = (r: ServerResponse) => {\n      if (r.state) {\n        var myTurn = this.isMyTurn(r.state.turn);\n        if (!myTurn) this.setState({mode: \"waiting\"});\n        else {\n          if (this.state.mode == \"waiting\") {\n            favicon.badge('!' as any);\n            (document.getElementById(\"notify\") as HTMLAudioElement).play();\n          }\n          this.setState({mode: \"normal\"});\n        }\n\n        if (this.state.selectedPlayer == -1 && this.props.pid < 4) {\n          this.setState({selectedPlayer: this.props.pid});\n        }\n\n        this.setState({\n          log: r.state.log,\n          cards: r.state.cards,\n          decks: r.state.decks,\n          players: r.state.players,\n          gems: r.state.gems,\n          nobles: r.state.nobles,\n          turn: r.state.turn,\n          turn_seconds: r.state.turn_seconds,\n          turn_deadline: r.state.turn_deadline,\n          nowMs: Date.now(),\n        });\n\n        if (r.state.winner !== null && this.state.phase != \"postgame\") {\n          alert(r.state.players[r.state.winner].name + \" wins!\");\n          this.setState({phase: \"postgame\"});\n        }\n\n        if (r.chat) {\n          var chat = this.state.chat;\n          if (chat && chat[chat.length - 1] && r.chat[r.chat.length -1]) {\n            var lastLocalChat = chat[chat.length - 1];\n            var lastRemoteChat = r.chat[r.chat.length - 1];\n            if (lastLocalChat.msg != lastRemoteChat.msg && lastRemoteChat.pid != this.props.pid) {\n              favicon.badge('.' as any);\n              (document.getElementById(\"notify\") as HTMLAudioElement).play();\n              if (!this.state.showChat) this.setState({ chatNotify: true })\n            }\n          }\n          this.setState({ chat: r.chat });\n        }\n\n        for (const scroller of document.getElementsByClassName(\"scroller\")) {\n          scroller.scrollTop = scroller.scrollHeight\n        }\n      }\n    }\n\n    loginArgs = () => {\n      return '?pid=' + this.props.pid + '&uuid=' + this.props.uuid\n    }\n\n    take = (color: string) => {\n      this.act('take', color)\n    }\n\n    discard = (color: string) => {\n      if (confirm(\"Are you sure you want to discard a gem?\")) {\n        this.act('discard', color)\n      }\n    }\n\n    selectPlayer = (player: number) => {\n      this.setState({ selectedPlayer: player })\n    }\n\n    buy = (uuid: string) => {\n      this.act('buy', uuid)\n    }\n\n    reserve = (uuid: string) => {\n      this.act('reserve', uuid)\n    }\n\n    noble = (uuid: string) => {\n      this.act('noble_visit', uuid);\n    }\n\n    rename = async (name: string) => {\n      const resp = await fetch(`/rename/${this.props.gid}/${name}${this.loginArgs()}`, { method: 'POST' })\n      const json = await resp.json()\n      globalShowError(json)\n    }\n\n    act = async (action: string, target: string) => {\n      const resp = await fetch('/game/' + this.props.gid + '/' + action + '/' + target + this.loginArgs(), { method: 'POST' })\n      const json = await resp.json()\n      if (!globalShowError(json)) this.updateState(json)\n    }\n\n    nextTurn = async () => {\n      const resp = await fetch('/game/' + this.props.gid + '/next' + this.loginArgs(), { method: 'POST' })\n      const json = await resp.json()\n      if (!globalShowError(json)) this.updateState(json)\n    }\n\n    poll = async () => {\n      const resp = await fetch('/poll/' + this.props.gid + this.loginArgs())\n      const json = await resp.json()\n      if (!globalShowError(json)) {\n        this.updateState(json)\n        this.poll()\n      }\n    }\n\n    stat = async () => {\n      const resp = await fetch(`/stat/${this.props.gid}${this.loginArgs()}`)\n      const json = await resp.json()\n      if (!globalShowError(json)) this.updateState(json)\n    }\n\n    componentDidMount() {\n      this.stat()\n      this.poll()\n      this.ticker = window.setInterval(() => this.setState({ nowMs: Date.now() }), 1000)\n      this.timeoutAudio = document.getElementById(\"timeout\") as HTMLAudioElement | null\n      if (this.timeoutAudio) {\n        this.timeoutAudio.loop = true\n      }\n    }\n\n    componentDidUpdate() {\n      this.syncTimeoutAudio()\n    }\n\n    componentWillUnmount() {\n      if (this.ticker !== null) {\n        window.clearInterval(this.ticker)\n      }\n      this.stopTimeoutAudio()\n    }\n\n    turnRemaining = () => {\n      if (this.state.turn < 0 || !this.state.turn_deadline) return null\n      const remaining = Math.ceil(this.state.turn_deadline - this.state.nowMs / 1000)\n      return Math.max(0, remaining)\n    }\n\n    stopTimeoutAudio = () => {\n      if (!this.timeoutAudio) return\n      this.timeoutAudio.pause()\n      this.timeoutAudio.currentTime = 0\n    }\n\n    syncTimeoutAudio = () => {\n      if (!this.timeoutAudio) return\n      const remaining = this.turnRemaining()\n      const shouldPlay = remaining !== null && remaining > 0 && remaining <= 10 && this.state.turn === this.props.pid\n      if (shouldPlay) {\n        if (this.timeoutAudio.paused) {\n          this.timeoutAudio.play().catch(() => {})\n        }\n      } else {\n        this.stopTimeoutAudio()\n      }\n    }\n\n    chat = async (e: React.KeyboardEvent<HTMLInputElement>) => {\n      const chatBox = document.getElementById(\"chat-inner\") as HTMLInputElement\n      if (e.which == 13) {\n        const resp = await fetch('/game/' + this.props.gid + '/chat' + this.loginArgs(), {\n          method: 'POST',\n          body: JSON.stringify({ msg: chatBox.value }),\n        })\n        chatBox.value = \"\"\n        const json = await resp.json()\n        if (!globalShowError(json)) this.updateState(json)\n      }\n    }\n\n    render() {\n      var players = this.state.players.map((player) => {\n        return (\n          <Player\n            selectedPlayer={this.state.selectedPlayer}\n            key={player.uuid}\n            pid={player.id}\n            name={player.name}\n            points={player.score}\n            game={this}\n            cards={player.cards}\n            nobles={player.nobles}\n            gems={player.gems}\n            reserved={player.reserved}\n            nreserved={player.reserved.length}\n          />\n        );\n      });\n      var gems = mapColors(this.state.gems, this, this.take, '', 'game');\n      var nobles = mapNobles(this.state.nobles, this);\n      var log = this.state.log.map((logLine, i) => {\n        return (\n          <div key={\"log-line-\" + i} className=\"line\">\n            <span className=\"pid\">{\"[\" + logLine.pid + \"] \"}</span>\n            <span className=\"msg\">{logLine.msg}</span>\n          </div>\n        );\n      });\n      var chat = this.state.chat.map((chatLine, i) => {\n        return (\n          <div key={\"chat-line-\" + i} className=\"line\">\n            <span className={`name name${chatLine.pid}`}>{chatLine.name + \": \"}</span>\n            <span className=\"msg\">{chatLine.msg}</span>\n          </div>\n        );\n      });\n      var levels = levelNames.map((level) => {\n        return (\n          <Level\n            key = {level}\n            game = {this}\n            name = {level}\n            cards = {this.state.cards[level]}\n            remaining = {this.state.decks[level]}\n          />\n        )\n      });\n      const turnRemaining = this.turnRemaining()\n      return (\n        <div>\n          <div id=\"game-board\">\n            <div id=\"common-area\">\n              <div id=\"noble-area\" className=\"split\">\n                {nobles}\n              </div>\n              <div id=\"level-area\" className=\"split\">\n                {levels}\n              </div>\n              <div className=\"reserve-info\">\n                <div className=\"reserve-info-inner\">\n                  <div>Click on card to buy, click on </div><div><img className=\"floppy\" src=\"client/img/floppy.png\" /></div><div> to reserve.</div>\n                </div>\n              </div>\n              <div id=\"gem-area\" className=\"you\">\n                {gems}\n              </div>\n            </div>\n            <div id=\"player-area\">\n              {players}\n            </div>\n          </div>\n          <div id=\"log-box\" style={{ bottom: this.state.showLog ? -4 : -514 }}>\n            <div className=\"title\" onClick={() => this.setState({ showLog: !this.state.showLog })}>::Log</div>\n            <div className=\"scroller\">\n              {log}\n            </div>\n          </div>\n          <div id=\"chat-box\" onClick={() => this.setState({ chatNotify: false })} style={{ bottom: this.state.showChat ? -4 : -314 }}>\n            <div className={`title${ this.state.chatNotify ? \" blinking\" : \"\"}`} onClick={() => this.setState({ showChat: !this.state.showChat })}>::Chat</div>\n            <div className=\"scroller\">\n              {chat}\n            </div>\n            <div id=\"chat\">\n              <span id=\"prompt\">&gt;</span>\n              <input id=\"chat-inner\" type=\"text\" onKeyPress={this.chat}></input>\n            </div>\n          </div>\n          {(this.state.turn >= 0 && this.props.pid >= 0 && this.props.pid < 4) &&\n            <div id=\"turn-controls\">\n              {turnRemaining !== null &&\n                <div id=\"turn-timer\">\n                  {this.state.turn === this.props.pid ? \"Your turn\" : \"Turn\"}: {turnRemaining}s\n                </div>\n              }\n              <button id={`pass-turn`} onClick={this.nextTurn} style={{ opacity: this.isMyTurn(this.state.turn) ? 1 : 0.3 }}>Pass turn</button>\n            </div>\n          }\n        </div>\n      );\n    }\n  }\n\n  const ErrorMsg = (props: { error: string | null, opacity: number }) => {\n    return <div className=\"error-box\" style={{ opacity: props.opacity }}>\n      <div className=\"error-box-inner\">{props.error}</div>\n    </div>\n  }\n\n  interface GameCreatorState {\n    startKey: string | null\n    loading: boolean\n    lobby: boolean\n    gameName: string\n    turnSecondsInput: string\n    joined: boolean\n    pid: number\n    uuid: string\n    gid: string\n    error: string | null\n    errorOpacity: number\n  }\n\n  class GameCreator extends React.PureComponent<{}, GameCreatorState> {\n    state = {\n      startKey: null,\n      loading: true,\n      lobby: false,\n      joined: false,\n      pid: -1,\n      uuid: '',\n      gid: '',\n      gameName: '',\n      turnSecondsInput: '30',\n      errorOpacity: 0,\n      error: null,\n    } as GameCreatorState\n\n    creating = false\n\n    join = async (game: string, act: string) => {\n      const session = this.readSession()\n      if (session[game] && !session[game].loading && (session[game].joined || act === 'spectate')) {\n        this.setState(session[game]);\n        this.save();\n        return;\n      }\n\n      const resp = await fetch(`/${act}/${game}`, { method: 'POST' })\n      const json = await resp.json()\n      if (json.status === 404) {\n        this.createGame()\n        return\n      }\n\n      if (this.showError(json)) return\n\n      this.setState({\n        joined: (act === 'join'),\n        loading: false,\n        pid: json.id,\n        uuid: json.uuid,\n        gid: game,\n      })\n      this.save()\n    }\n\n    showError = (resp: ServerResponse): boolean => {\n      let msg: string | null = null\n      if (!resp) {\n        msg = \"Request failed\";\n        return true\n      }\n      else if (!resp.error && (!resp.result || !resp.result.error)) return false;\n      else msg = resp.error || resp.result.error;\n\n      if (resp.status === 404) {\n        this.clear()\n        this.setState({ loading: true, joined: false, pid: -1, uuid: '' })\n        this.join(this.state.gid, 'spectate')\n        return true\n      }\n\n      this.setState({ error: msg, errorOpacity: 1 })\n\n      clearTimeout(errorTimeout);\n      errorTimeout = setTimeout(() => {\n        this.setState({ errorOpacity: 0 })\n      }, 4000)\n\n      return true\n    }\n\n    createGame = async () => {\n      if (this.creating) return\n      this.creating = true\n      const gameName = this.state.gid === '' ? this.state.gameName : this.state.gid\n      const parsedTurnSeconds = parseInt((this.state.turnSecondsInput || '').trim(), 10)\n      const turnSeconds = Number.isFinite(parsedTurnSeconds) && parsedTurnSeconds > 0 ? parsedTurnSeconds : 30\n      const resp = await fetch(`/create/${gameName}`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ turnSeconds }),\n      })\n      const json = await resp.json()\n\n      if (this.showError(json)) return\n\n      history.replaceState(null, \"Splendor\", `/${json.game}`)\n      this.join(json.game, 'join')\n      this.setState({ startKey: json.start, loading: true, lobby: false })\n    }\n\n    readSession = () => {\n      var session = window.localStorage.getItem('splendor');\n      if (session === null) return {};\n      return JSON.parse(session);\n    }\n\n    componentDidMount() {\n      globalShowError = this.showError\n\n      if (window.location.pathname === \"/\") {\n        fetch(`/suggest`).then(async (resp) => {\n          const json = await resp.json()\n          this.setState({\n            lobby: true,\n            gameName: json.result.game,\n            loading: false,\n          })\n        })\n        return\n      }\n\n      const gid = window.location.pathname.substring(1)\n      var session = this.readSession()\n      this.setState({\n        ...session[gid],\n        gid,\n      })\n      if (this.state.loading) {\n        this.join(gid, 'spectate')\n      }\n    }\n\n    save = () => {\n      setTimeout(() => {\n        this.saveRaw(this.state)\n      }, 100)\n    }\n\n    clear = () => {\n      this.saveRaw(null)\n    }\n\n    saveRaw = (state: any) => {\n      const session = this.readSession();\n      if (state === null) delete session[this.state.gid]\n      else session[this.state.gid] = state\n      window.localStorage['splendor'] = JSON.stringify(session);\n    }\n\n    startGame = async () => {\n      const resp = await fetch(`/start/${this.state.gid}/${this.state.startKey}`, { method: \"POST\" })\n      const json = await resp.json()\n\n      if (!this.showError(json)) {\n        this.setState({ startKey: null });\n        this.save();\n      }\n    }\n\n    nameChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n      this.setState({ gameName: e.target.value })\n    }\n\n    turnSecondsChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n      this.setState({ turnSecondsInput: e.target.value })\n    }\n\n    keyPress = (e: React.KeyboardEvent<HTMLInputElement>) => {\n      if (e.key === \"Enter\") this.createGame()\n    }\n\n    render() {\n      if (this.state.loading) {\n        return <div id=\"game\">\n          <ErrorMsg error={this.state.error} opacity={this.state.errorOpacity} />\n        </div>\n      }\n\n      if (this.state.lobby) {\n        return <div className=\"lobby\">\n          <div className=\"main-title\">Splendor</div>\n          <div className=\"desc\">Play Splendor online with others. Enter a game name or use the suggested game name to start a game.</div>\n          <div className=\"lobby-form\">\n            <div className=\"input-row\">\n              <span className=\"input-label\">Game Name:</span>\n              <input className=\"game-name lobby-input\" type=\"text\" onChange={this.nameChange} onKeyPress={this.keyPress} value={this.state.gameName} />\n            </div>\n            <div className=\"input-row\">\n              <span className=\"input-label\">Turn Time:</span>\n              <input className=\"game-name lobby-input lobby-seconds\" type=\"number\" min={1} onChange={this.turnSecondsChange} onKeyPress={this.keyPress} value={this.state.turnSecondsInput} />\n              <span className=\"input-suffix\">seconds / turn</span>\n            </div>\n            <div className=\"input-row input-row-actions\">\n              <button onClick={this.createGame} className=\"create-game\">Create Game</button>\n            </div>\n          </div>\n          <ErrorMsg error={this.state.error} opacity={this.state.errorOpacity} />\n        </div>\n      }\n\n      return (\n        <div id=\"game\">\n          <div id=\"game-title\">\n            <div className=\"link\">\n              Share this link with friends to join in or watch: <a href=\".\">{`${document.location.href}`}</a>\n            </div>\n            <div className=\"buttons\">\n              {!this.state.joined &&\n                <button className=\"start-game\" onClick={() => this.join(this.state.gid, 'join')}>Join Game</button>\n              }\n              {this.state.startKey && this.state.pid == 0 &&\n                <button className=\"start-game\" onClick={this.startGame}>Start Game</button>\n              }\n            </div>\n          </div>\n          {this.state.pid >= 0 && this.state.gid && this.state.uuid &&\n            <Game key={this.state.pid} gid={this.state.gid} pid={this.state.pid} uuid={this.state.uuid} />\n          }\n          <ErrorMsg error={this.state.error} opacity={this.state.errorOpacity} />\n        </div>\n      )\n    }\n  }\n\n  const favicon=new Favico({\n    position : 'up'\n  })\n\n  document.onclick = () => {\n    favicon.badge('' as any)\n  }\n\n  ReactDOM.render(\n    <div>\n      <GameCreator />\n    </div>,\n    document.getElementById('content')\n  )\n})()\n","module.exports = React;","module.exports = ReactDOM;","/**\n * @license MIT\n * @fileOverview Favico animations\n * @author Miroslav Magda, http://blog.ejci.net\n * @version 0.3.10\n */\n\n/**\n * Create new favico instance\n * @param {Object} Options\n * @return {Object} Favico object\n * @example\n * var favico = new Favico({\n *    bgColor : '#d00',\n *    textColor : '#fff',\n *    fontFamily : 'sans-serif',\n *    fontStyle : 'bold',\n *    position : 'down',\n *    type : 'circle',\n *    animation : 'slide',\n *    dataUrl: function(url){},\n *    win: top\n * });\n */\n(function () {\n\n\tvar Favico = (function (opt) {\n\t\t'use strict';\n\t\topt = (opt) ? opt : {};\n\t\tvar _def = {\n\t\t\tbgColor: '#d00',\n\t\t\ttextColor: '#fff',\n\t\t\tfontFamily: 'sans-serif', //Arial,Verdana,Times New Roman,serif,sans-serif,...\n\t\t\tfontStyle: 'bold', //normal,italic,oblique,bold,bolder,lighter,100,200,300,400,500,600,700,800,900\n\t\t\ttype: 'circle',\n\t\t\tposition: 'down', // down, up, left, leftup (upleft)\n\t\t\tanimation: 'slide',\n\t\t\telementId: false,\n\t\t\tdataUrl: false,\n\t\t\twin: window\n\t\t};\n\t\tvar _opt, _orig, _h, _w, _canvas, _context, _img, _ready, _lastBadge, _running, _readyCb, _stop, _browser, _animTimeout, _drawTimeout, _doc;\n\n\t\t_browser = {};\n\t\t_browser.ff = typeof InstallTrigger != 'undefined';\n\t\t_browser.chrome = !!window.chrome;\n\t\t_browser.opera = !!window.opera || navigator.userAgent.indexOf('Opera') >= 0;\n\t\t_browser.ie = /*@cc_on!@*/false;\n\t\t_browser.safari = Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0;\n\t\t_browser.supported = (_browser.chrome || _browser.ff || _browser.opera);\n\n\t\tvar _queue = [];\n\t\t_readyCb = function () {\n\t\t};\n\t\t_ready = _stop = false;\n\t\t/**\n\t\t * Initialize favico\n\t\t */\n\t\tvar init = function () {\n\t\t\t//merge initial options\n\t\t\t_opt = merge(_def, opt);\n\t\t\t_opt.bgColor = hexToRgb(_opt.bgColor);\n\t\t\t_opt.textColor = hexToRgb(_opt.textColor);\n\t\t\t_opt.position = _opt.position.toLowerCase();\n\t\t\t_opt.animation = (animation.types['' + _opt.animation]) ? _opt.animation : _def.animation;\n\n\t\t\t_doc = _opt.win.document;\n\n\t\t\tvar isUp = _opt.position.indexOf('up') > -1;\n\t\t\tvar isLeft = _opt.position.indexOf('left') > -1;\n\n\t\t\t//transform animation\n\t\t\tif (isUp || isLeft) {\n\t\t\t\tfor (var i = 0; i < animation.types['' + _opt.animation].length; i++) {\n\t\t\t\t\tvar step = animation.types['' + _opt.animation][i];\n\n\t\t\t\t\tif (isUp) {\n\t\t\t\t\t\tif (step.y < 0.6) {\n\t\t\t\t\t\t\tstep.y = step.y - 0.4;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstep.y = step.y - 2 * step.y + (1 - step.w);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isLeft) {\n\t\t\t\t\t\tif (step.x < 0.6) {\n\t\t\t\t\t\t\tstep.x = step.x - 0.4;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstep.x = step.x - 2 * step.x + (1 - step.h);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tanimation.types['' + _opt.animation][i] = step;\n\t\t\t\t}\n\t\t\t}\n\t\t\t_opt.type = (type['' + _opt.type]) ? _opt.type : _def.type;\n\n\t\t\t_orig = link.getIcon();\n\t\t\t//create temp canvas\n\t\t\t_canvas = document.createElement('canvas');\n\t\t\t//create temp image\n\t\t\t_img = document.createElement('img');\n\t\t\tif (_orig.hasAttribute('href')) {\n\t\t\t\t_img.setAttribute('crossOrigin', 'anonymous');\n\t\t\t\t//get width/height\n\t\t\t\t_img.onload = function () {\n\t\t\t\t\t_h = (_img.height > 0) ? _img.height : 32;\n\t\t\t\t\t_w = (_img.width > 0) ? _img.width : 32;\n\t\t\t\t\t_canvas.height = _h;\n\t\t\t\t\t_canvas.width = _w;\n\t\t\t\t\t_context = _canvas.getContext('2d');\n\t\t\t\t\ticon.ready();\n\t\t\t\t};\n\t\t\t\t_img.setAttribute('src', _orig.getAttribute('href'));\n\t\t\t} else {\n\t\t\t\t_img.onload = function () {\n\t\t\t\t\t_h = 32;\n\t\t\t\t\t_w = 32;\n\t\t\t\t\t_img.height = _h;\n\t\t\t\t\t_img.width = _w;\n\t\t\t\t\t_canvas.height = _h;\n\t\t\t\t\t_canvas.width = _w;\n\t\t\t\t\t_context = _canvas.getContext('2d');\n\t\t\t\t\ticon.ready();\n\t\t\t\t};\n\t\t\t\t_img.setAttribute('src', '');\n\t\t\t}\n\n\t\t};\n\t\t/**\n\t\t * Icon namespace\n\t\t */\n\t\tvar icon = {};\n\t\t/**\n\t\t * Icon is ready (reset icon) and start animation (if ther is any)\n\t\t */\n\t\ticon.ready = function () {\n\t\t\t_ready = true;\n\t\t\ticon.reset();\n\t\t\t_readyCb();\n\t\t};\n\t\t/**\n\t\t * Reset icon to default state\n\t\t */\n\t\ticon.reset = function () {\n\t\t\t//reset\n\t\t\tif (!_ready) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t_queue = [];\n\t\t\t_lastBadge = false;\n\t\t\t_running = false;\n\t\t\t_context.clearRect(0, 0, _w, _h);\n\t\t\t_context.drawImage(_img, 0, 0, _w, _h);\n\t\t\t//_stop=true;\n\t\t\tlink.setIcon(_canvas);\n\t\t\t//webcam('stop');\n\t\t\t//video('stop');\n\t\t\twindow.clearTimeout(_animTimeout);\n\t\t\twindow.clearTimeout(_drawTimeout);\n\t\t};\n\t\t/**\n\t\t * Start animation\n\t\t */\n\t\ticon.start = function () {\n\t\t\tif (!_ready || _running) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar finished = function () {\n\t\t\t\t_lastBadge = _queue[0];\n\t\t\t\t_running = false;\n\t\t\t\tif (_queue.length > 0) {\n\t\t\t\t\t_queue.shift();\n\t\t\t\t\ticon.start();\n\t\t\t\t} else {\n\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (_queue.length > 0) {\n\t\t\t\t_running = true;\n\t\t\t\tvar run = function () {\n\t\t\t\t\t// apply options for this animation\n\t\t\t\t\t['type', 'animation', 'bgColor', 'textColor', 'fontFamily', 'fontStyle'].forEach(function (a) {\n\t\t\t\t\t\tif (a in _queue[0].options) {\n\t\t\t\t\t\t\t_opt[a] = _queue[0].options[a];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tanimation.run(_queue[0].options, function () {\n\t\t\t\t\t\tfinished();\n\t\t\t\t\t}, false);\n\t\t\t\t};\n\t\t\t\tif (_lastBadge) {\n\t\t\t\t\tanimation.run(_lastBadge.options, function () {\n\t\t\t\t\t\trun();\n\t\t\t\t\t}, true);\n\t\t\t\t} else {\n\t\t\t\t\trun();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Badge types\n\t\t */\n\t\tvar type = {};\n\t\tvar options = function (opt) {\n\t\t\topt.n = ((typeof opt.n) === 'number') ? Math.abs(opt.n | 0) : opt.n;\n\t\t\topt.x = _w * opt.x;\n\t\t\topt.y = _h * opt.y;\n\t\t\topt.w = _w * opt.w;\n\t\t\topt.h = _h * opt.h;\n\t\t\topt.len = (\"\" + opt.n).length;\n\t\t\treturn opt;\n\t\t};\n\t\t/**\n\t\t * Generate circle\n\t\t * @param {Object} opt Badge options\n\t\t */\n\t\ttype.circle = function (opt) {\n\t\t\topt = options(opt);\n\t\t\tvar more = false;\n\t\t\tif (opt.len === 2) {\n\t\t\t\topt.x = opt.x - opt.w * 0.4;\n\t\t\t\topt.w = opt.w * 1.4;\n\t\t\t\tmore = true;\n\t\t\t} else if (opt.len >= 3) {\n\t\t\t\topt.x = opt.x - opt.w * 0.65;\n\t\t\t\topt.w = opt.w * 1.65;\n\t\t\t\tmore = true;\n\t\t\t}\n\t\t\t_context.clearRect(0, 0, _w, _h);\n\t\t\t_context.drawImage(_img, 0, 0, _w, _h);\n\t\t\t_context.beginPath();\n\t\t\t_context.font = _opt.fontStyle + \" \" + Math.floor(opt.h * (opt.n > 99 ? 0.85 : 1)) + \"px \" + _opt.fontFamily;\n\t\t\t_context.textAlign = 'center';\n\t\t\tif (more) {\n\t\t\t\t_context.moveTo(opt.x + opt.w / 2, opt.y);\n\t\t\t\t_context.lineTo(opt.x + opt.w - opt.h / 2, opt.y);\n\t\t\t\t_context.quadraticCurveTo(opt.x + opt.w, opt.y, opt.x + opt.w, opt.y + opt.h / 2);\n\t\t\t\t_context.lineTo(opt.x + opt.w, opt.y + opt.h - opt.h / 2);\n\t\t\t\t_context.quadraticCurveTo(opt.x + opt.w, opt.y + opt.h, opt.x + opt.w - opt.h / 2, opt.y + opt.h);\n\t\t\t\t_context.lineTo(opt.x + opt.h / 2, opt.y + opt.h);\n\t\t\t\t_context.quadraticCurveTo(opt.x, opt.y + opt.h, opt.x, opt.y + opt.h - opt.h / 2);\n\t\t\t\t_context.lineTo(opt.x, opt.y + opt.h / 2);\n\t\t\t\t_context.quadraticCurveTo(opt.x, opt.y, opt.x + opt.h / 2, opt.y);\n\t\t\t} else {\n\t\t\t\t_context.arc(opt.x + opt.w / 2, opt.y + opt.h / 2, opt.h / 2, 0, 2 * Math.PI);\n\t\t\t}\n\t\t\t_context.fillStyle = 'rgba(' + _opt.bgColor.r + ',' + _opt.bgColor.g + ',' + _opt.bgColor.b + ',' + opt.o + ')';\n\t\t\t_context.fill();\n\t\t\t_context.closePath();\n\t\t\t_context.beginPath();\n\t\t\t_context.stroke();\n\t\t\t_context.fillStyle = 'rgba(' + _opt.textColor.r + ',' + _opt.textColor.g + ',' + _opt.textColor.b + ',' + opt.o + ')';\n\t\t\t//_context.fillText((more) ? '9+' : opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));\n\t\t\tif ((typeof opt.n) === 'number' && opt.n > 999) {\n\t\t\t\t_context.fillText(((opt.n > 9999) ? 9 : Math.floor(opt.n / 1000)) + 'k+', Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.2));\n\t\t\t} else {\n\t\t\t\t_context.fillText(opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));\n\t\t\t}\n\t\t\t_context.closePath();\n\t\t};\n\t\t/**\n\t\t * Generate rectangle\n\t\t * @param {Object} opt Badge options\n\t\t */\n\t\ttype.rectangle = function (opt) {\n\t\t\topt = options(opt);\n\t\t\tvar more = false;\n\t\t\tif (opt.len === 2) {\n\t\t\t\topt.x = opt.x - opt.w * 0.4;\n\t\t\t\topt.w = opt.w * 1.4;\n\t\t\t\tmore = true;\n\t\t\t} else if (opt.len >= 3) {\n\t\t\t\topt.x = opt.x - opt.w * 0.65;\n\t\t\t\topt.w = opt.w * 1.65;\n\t\t\t\tmore = true;\n\t\t\t}\n\t\t\t_context.clearRect(0, 0, _w, _h);\n\t\t\t_context.drawImage(_img, 0, 0, _w, _h);\n\t\t\t_context.beginPath();\n\t\t\t_context.font = _opt.fontStyle + \" \" + Math.floor(opt.h * (opt.n > 99 ? 0.9 : 1)) + \"px \" + _opt.fontFamily;\n\t\t\t_context.textAlign = 'center';\n\t\t\t_context.fillStyle = 'rgba(' + _opt.bgColor.r + ',' + _opt.bgColor.g + ',' + _opt.bgColor.b + ',' + opt.o + ')';\n\t\t\t_context.fillRect(opt.x, opt.y, opt.w, opt.h);\n\t\t\t_context.fillStyle = 'rgba(' + _opt.textColor.r + ',' + _opt.textColor.g + ',' + _opt.textColor.b + ',' + opt.o + ')';\n\t\t\t//_context.fillText((more) ? '9+' : opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));\n\t\t\tif ((typeof opt.n) === 'number' && opt.n > 999) {\n\t\t\t\t_context.fillText(((opt.n > 9999) ? 9 : Math.floor(opt.n / 1000)) + 'k+', Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.2));\n\t\t\t} else {\n\t\t\t\t_context.fillText(opt.n, Math.floor(opt.x + opt.w / 2), Math.floor(opt.y + opt.h - opt.h * 0.15));\n\t\t\t}\n\t\t\t_context.closePath();\n\t\t};\n\n\t\t/**\n\t\t * Set badge\n\t\t */\n\t\tvar badge = function (number, opts) {\n\t\t\topts = ((typeof opts) === 'string' ? {\n\t\t\t\tanimation: opts\n\t\t\t} : opts) || {};\n\t\t\t_readyCb = function () {\n\t\t\t\ttry {\n\t\t\t\t\tif (typeof (number) === 'number' ? (number > 0) : (number !== '')) {\n\t\t\t\t\t\tvar q = {\n\t\t\t\t\t\t\ttype: 'badge',\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tn: number\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif ('animation' in opts && animation.types['' + opts.animation]) {\n\t\t\t\t\t\t\tq.options.animation = '' + opts.animation;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ('type' in opts && type['' + opts.type]) {\n\t\t\t\t\t\t\tq.options.type = '' + opts.type;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t['bgColor', 'textColor'].forEach(function (o) {\n\t\t\t\t\t\t\tif (o in opts) {\n\t\t\t\t\t\t\t\tq.options[o] = hexToRgb(opts[o]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t['fontStyle', 'fontFamily'].forEach(function (o) {\n\t\t\t\t\t\t\tif (o in opts) {\n\t\t\t\t\t\t\t\tq.options[o] = opts[o];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t_queue.push(q);\n\t\t\t\t\t\tif (_queue.length > 100) {\n\t\t\t\t\t\t\tthrow new Error('Too many badges requests in queue.');\n\t\t\t\t\t\t}\n\t\t\t\t\t\ticon.start();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ticon.reset();\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthrow new Error('Error setting badge. Message: ' + e.message);\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (_ready) {\n\t\t\t\t_readyCb();\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Set image as icon\n\t\t */\n\t\tvar image = function (imageElement) {\n\t\t\t_readyCb = function () {\n\t\t\t\ttry {\n\t\t\t\t\tvar w = imageElement.width;\n\t\t\t\t\tvar h = imageElement.height;\n\t\t\t\t\tvar newImg = document.createElement('img');\n\t\t\t\t\tvar ratio = (w / _w < h / _h) ? (w / _w) : (h / _h);\n\t\t\t\t\tnewImg.setAttribute('crossOrigin', 'anonymous');\n\t\t\t\t\tnewImg.onload=function(){\n\t\t\t\t\t\t_context.clearRect(0, 0, _w, _h);\n\t\t\t\t\t\t_context.drawImage(newImg, 0, 0, _w, _h);\n\t\t\t\t\t\tlink.setIcon(_canvas);\n\t\t\t\t\t};\n\t\t\t\t\tnewImg.setAttribute('src', imageElement.getAttribute('src'));\n\t\t\t\t\tnewImg.height = (h / ratio);\n\t\t\t\t\tnewImg.width = (w / ratio);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthrow new Error('Error setting image. Message: ' + e.message);\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (_ready) {\n\t\t\t\t_readyCb();\n\t\t\t}\n\t\t};\n\t\t/**\n\t\t * Set video as icon\n\t\t */\n\t\tvar video = function (videoElement) {\n\t\t\t_readyCb = function () {\n\t\t\t\ttry {\n\t\t\t\t\tif (videoElement === 'stop') {\n\t\t\t\t\t\t_stop = true;\n\t\t\t\t\t\ticon.reset();\n\t\t\t\t\t\t_stop = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t//var w = videoElement.width;\n\t\t\t\t\t//var h = videoElement.height;\n\t\t\t\t\t//var ratio = (w / _w < h / _h) ? (w / _w) : (h / _h);\n\t\t\t\t\tvideoElement.addEventListener('play', function () {\n\t\t\t\t\t\tdrawVideo(this);\n\t\t\t\t\t}, false);\n\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthrow new Error('Error setting video. Message: ' + e.message);\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (_ready) {\n\t\t\t\t_readyCb();\n\t\t\t}\n\t\t};\n\t\t/**\n\t\t * Set video as icon\n\t\t */\n\t\tvar webcam = function (action) {\n\t\t\t//UR\n\t\t\tif (!window.URL || !window.URL.createObjectURL) {\n\t\t\t\twindow.URL = window.URL || {};\n\t\t\t\twindow.URL.createObjectURL = function (obj) {\n\t\t\t\t\treturn obj;\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (_browser.supported) {\n\t\t\t\tvar newVideo = false;\n\t\t\t\tnavigator.getUserMedia = navigator.getUserMedia || navigator.oGetUserMedia || navigator.msGetUserMedia || navigator.mozGetUserMedia || navigator.webkitGetUserMedia;\n\t\t\t\t_readyCb = function () {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (action === 'stop') {\n\t\t\t\t\t\t\t_stop = true;\n\t\t\t\t\t\t\ticon.reset();\n\t\t\t\t\t\t\t_stop = false;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewVideo = document.createElement('video');\n\t\t\t\t\t\tnewVideo.width = _w;\n\t\t\t\t\t\tnewVideo.height = _h;\n\t\t\t\t\t\tnavigator.getUserMedia({\n\t\t\t\t\t\t\tvideo: true,\n\t\t\t\t\t\t\taudio: false\n\t\t\t\t\t\t}, function (stream) {\n\t\t\t\t\t\t\tnewVideo.src = URL.createObjectURL(stream);\n\t\t\t\t\t\t\tnewVideo.play();\n\t\t\t\t\t\t\tdrawVideo(newVideo);\n\t\t\t\t\t\t}, function () {\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tthrow new Error('Error setting webcam. Message: ' + e.message);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (_ready) {\n\t\t\t\t\t_readyCb();\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\n\t\t/**\n\t\t * Draw video to context and repeat :)\n\t\t */\n\t\tfunction drawVideo(video) {\n\t\t\tif (video.paused || video.ended || _stop) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t//nasty hack for FF webcam (Thanks to Julian Ćwirko, kontakt@redsunmedia.pl)\n\t\t\ttry {\n\t\t\t\t_context.clearRect(0, 0, _w, _h);\n\t\t\t\t_context.drawImage(video, 0, 0, _w, _h);\n\t\t\t} catch (e) {\n\n\t\t\t}\n\t\t\t_drawTimeout = setTimeout(function () {\n\t\t\t\tdrawVideo(video);\n\t\t\t}, animation.duration);\n\t\t\tlink.setIcon(_canvas);\n\t\t}\n\n\t\tvar link = {};\n\t\t/**\n\t\t * Get icon from HEAD tag or create a new <link> element\n\t\t */\n\t\tlink.getIcon = function () {\n\t\t\tvar elm = false;\n\t\t\t//get link element\n\t\t\tvar getLink = function () {\n\t\t\t\tvar link = _doc.getElementsByTagName('head')[0].getElementsByTagName('link');\n\t\t\t\tfor (var l = link.length, i = (l - 1); i >= 0; i--) {\n\t\t\t\t\tif ((/(^|\\s)icon(\\s|$)/i).test(link[i].getAttribute('rel'))) {\n\t\t\t\t\t\treturn link[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tif (_opt.element) {\n\t\t\t\telm = _opt.element;\n\t\t\t} else if (_opt.elementId) {\n\t\t\t\t//if img element identified by elementId\n\t\t\t\telm = _doc.getElementById(_opt.elementId);\n\t\t\t\telm.setAttribute('href', elm.getAttribute('src'));\n\t\t\t} else {\n\t\t\t\t//if link element\n\t\t\t\telm = getLink();\n\t\t\t\tif (elm === false) {\n\t\t\t\t\telm = _doc.createElement('link');\n\t\t\t\t\telm.setAttribute('rel', 'icon');\n\t\t\t\t\t_doc.getElementsByTagName('head')[0].appendChild(elm);\n\t\t\t\t}\n\t\t\t}\n\t\t\telm.setAttribute('type', 'image/png');\n\t\t\treturn elm;\n\t\t};\n\t\tlink.setIcon = function (canvas) {\n\t\t\tvar url = canvas.toDataURL('image/png');\n\t\t\tif (_opt.dataUrl) {\n\t\t\t\t//if using custom exporter\n\t\t\t\t_opt.dataUrl(url);\n\t\t\t}\n\t\t\tif (_opt.element) {\n\t\t\t\t_opt.element.setAttribute('href', url);\n\t\t\t\t_opt.element.setAttribute('src', url);\n\t\t\t} else if (_opt.elementId) {\n\t\t\t\t//if is attached to element (image)\n\t\t\t\tvar elm = _doc.getElementById(_opt.elementId);\n\t\t\t\telm.setAttribute('href', url);\n\t\t\t\telm.setAttribute('src', url);\n\t\t\t} else {\n\t\t\t\t//if is attached to fav icon\n\t\t\t\tif (_browser.ff || _browser.opera) {\n\t\t\t\t\t//for FF we need to \"recreate\" element, atach to dom and remove old <link>\n\t\t\t\t\t//var originalType = _orig.getAttribute('rel');\n\t\t\t\t\tvar old = _orig;\n\t\t\t\t\t_orig = _doc.createElement('link');\n\t\t\t\t\t//_orig.setAttribute('rel', originalType);\n\t\t\t\t\tif (_browser.opera) {\n\t\t\t\t\t\t_orig.setAttribute('rel', 'icon');\n\t\t\t\t\t}\n\t\t\t\t\t_orig.setAttribute('rel', 'icon');\n\t\t\t\t\t_orig.setAttribute('type', 'image/png');\n\t\t\t\t\t_doc.getElementsByTagName('head')[0].appendChild(_orig);\n\t\t\t\t\t_orig.setAttribute('href', url);\n\t\t\t\t\tif (old.parentNode) {\n\t\t\t\t\t\told.parentNode.removeChild(old);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t_orig.setAttribute('href', url);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t//http://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb#answer-5624139\n\t\t//HEX to RGB convertor\n\t\tfunction hexToRgb(hex) {\n\t\t\tvar shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n\t\t\thex = hex.replace(shorthandRegex, function (m, r, g, b) {\n\t\t\t\treturn r + r + g + g + b + b;\n\t\t\t});\n\t\t\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\t\t\treturn result ? {\n\t\t\t\tr: parseInt(result[1], 16),\n\t\t\t\tg: parseInt(result[2], 16),\n\t\t\t\tb: parseInt(result[3], 16)\n\t\t\t} : false;\n\t\t}\n\n\t\t/**\n\t\t * Merge options\n\t\t */\n\t\tfunction merge(def, opt) {\n\t\t\tvar mergedOpt = {};\n\t\t\tvar attrname;\n\t\t\tfor (attrname in def) {\n\t\t\t\tmergedOpt[attrname] = def[attrname];\n\t\t\t}\n\t\t\tfor (attrname in opt) {\n\t\t\t\tmergedOpt[attrname] = opt[attrname];\n\t\t\t}\n\t\t\treturn mergedOpt;\n\t\t}\n\n\t\t/**\n\t\t * Cross-browser page visibility shim\n\t\t * http://stackoverflow.com/questions/12536562/detect-whether-a-window-is-visible\n\t\t */\n\t\tfunction isPageHidden() {\n\t\t\treturn _doc.hidden || _doc.msHidden || _doc.webkitHidden || _doc.mozHidden;\n\t\t}\n\n\t\t/**\n\t\t * @namespace animation\n\t\t */\n\t\tvar animation = {};\n\t\t/**\n\t\t * Animation \"frame\" duration\n\t\t */\n\t\tanimation.duration = 40;\n\t\t/**\n\t\t * Animation types (none,fade,pop,slide)\n\t\t */\n\t\tanimation.types = {};\n\t\tanimation.types.fade = [{\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 0.0\n\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 0.1\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 0.2\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 0.3\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 0.4\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 0.5\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 0.6\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 0.7\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 0.8\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 0.9\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 1.0\n\t\t\t}];\n\t\tanimation.types.none = [{\n\t\t\tx: 0.4,\n\t\t\ty: 0.4,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}];\n\t\tanimation.types.pop = [{\n\t\t\tx: 1,\n\t\t\ty: 1,\n\t\t\tw: 0,\n\t\t\th: 0,\n\t\t\to: 1\n\t\t}, {\n\t\t\t\tx: 0.9,\n\t\t\t\ty: 0.9,\n\t\t\t\tw: 0.1,\n\t\t\t\th: 0.1,\n\t\t\t\to: 1\n\t\t\t}, {\n\t\t\t\tx: 0.8,\n\t\t\t\ty: 0.8,\n\t\t\t\tw: 0.2,\n\t\t\t\th: 0.2,\n\t\t\t\to: 1\n\t\t\t}, {\n\t\t\t\tx: 0.7,\n\t\t\t\ty: 0.7,\n\t\t\t\tw: 0.3,\n\t\t\t\th: 0.3,\n\t\t\t\to: 1\n\t\t\t}, {\n\t\t\t\tx: 0.6,\n\t\t\t\ty: 0.6,\n\t\t\t\tw: 0.4,\n\t\t\t\th: 0.4,\n\t\t\t\to: 1\n\t\t\t}, {\n\t\t\t\tx: 0.5,\n\t\t\t\ty: 0.5,\n\t\t\t\tw: 0.5,\n\t\t\t\th: 0.5,\n\t\t\t\to: 1\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 1\n\t\t\t}];\n\t\tanimation.types.popFade = [{\n\t\t\tx: 0.75,\n\t\t\ty: 0.75,\n\t\t\tw: 0,\n\t\t\th: 0,\n\t\t\to: 0\n\t\t}, {\n\t\t\t\tx: 0.65,\n\t\t\t\ty: 0.65,\n\t\t\t\tw: 0.1,\n\t\t\t\th: 0.1,\n\t\t\t\to: 0.2\n\t\t\t}, {\n\t\t\t\tx: 0.6,\n\t\t\t\ty: 0.6,\n\t\t\t\tw: 0.2,\n\t\t\t\th: 0.2,\n\t\t\t\to: 0.4\n\t\t\t}, {\n\t\t\t\tx: 0.55,\n\t\t\t\ty: 0.55,\n\t\t\t\tw: 0.3,\n\t\t\t\th: 0.3,\n\t\t\t\to: 0.6\n\t\t\t}, {\n\t\t\t\tx: 0.50,\n\t\t\t\ty: 0.50,\n\t\t\t\tw: 0.4,\n\t\t\t\th: 0.4,\n\t\t\t\to: 0.8\n\t\t\t}, {\n\t\t\t\tx: 0.45,\n\t\t\t\ty: 0.45,\n\t\t\t\tw: 0.5,\n\t\t\t\th: 0.5,\n\t\t\t\to: 0.9\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 1\n\t\t\t}];\n\t\tanimation.types.slide = [{\n\t\t\tx: 0.4,\n\t\t\ty: 1,\n\t\t\tw: 0.6,\n\t\t\th: 0.6,\n\t\t\to: 1\n\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.9,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 1\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.9,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 1\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.8,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 1\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.7,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 1\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.6,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 1\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.5,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 1\n\t\t\t}, {\n\t\t\t\tx: 0.4,\n\t\t\t\ty: 0.4,\n\t\t\t\tw: 0.6,\n\t\t\t\th: 0.6,\n\t\t\t\to: 1\n\t\t\t}];\n\t\t/**\n\t\t * Run animation\n\t\t * @param {Object} opt Animation options\n\t\t * @param {Object} cb Callabak after all steps are done\n\t\t * @param {Object} revert Reverse order? true|false\n\t\t * @param {Object} step Optional step number (frame bumber)\n\t\t */\n\t\tanimation.run = function (opt, cb, revert, step) {\n\t\t\tvar animationType = animation.types[isPageHidden() ? 'none' : _opt.animation];\n\t\t\tif (revert === true) {\n\t\t\t\tstep = (typeof step !== 'undefined') ? step : animationType.length - 1;\n\t\t\t} else {\n\t\t\t\tstep = (typeof step !== 'undefined') ? step : 0;\n\t\t\t}\n\t\t\tcb = (cb) ? cb : function () {\n\t\t\t};\n\t\t\tif ((step < animationType.length) && (step >= 0)) {\n\t\t\t\ttype[_opt.type](merge(opt, animationType[step]));\n\t\t\t\t_animTimeout = setTimeout(function () {\n\t\t\t\t\tif (revert) {\n\t\t\t\t\t\tstep = step - 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstep = step + 1;\n\t\t\t\t\t}\n\t\t\t\t\tanimation.run(opt, cb, revert, step);\n\t\t\t\t}, animation.duration);\n\n\t\t\t\tlink.setIcon(_canvas);\n\t\t\t} else {\n\t\t\t\tcb();\n\t\t\t\treturn;\n\t\t\t}\n\t\t};\n\t\t//auto init\n\t\tinit();\n\t\treturn {\n\t\t\tbadge: badge,\n\t\t\tvideo: video,\n\t\t\timage: image,\n\t\t\twebcam: webcam,\n\t\t\treset: icon.reset,\n\t\t\tbrowser: {\n\t\t\t\tsupported: _browser.supported\n\t\t\t}\n\t\t};\n\t});\n\n\t// AMD / RequireJS\n\tif (typeof define !== 'undefined' && define.amd) {\n\t\tdefine([], function () {\n\t\t\treturn Favico;\n\t\t});\n\t}\n\t// CommonJS\n\telse if (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = Favico;\n\t}\n\t// included directly via <script> tag\n\telse {\n\t\tthis.Favico = Favico;\n\t}\n\n})();\n"],"sourceRoot":""}